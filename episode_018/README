See Node Tuts episode 13 - Authentication in Express - Sessions and Route middleware

http://nodetuts.com/tutorials/13-authentication-in-express-sessions-and-route-middleware.html
